---
title: "Regression Modeling Assignment: Question 1"
author: "Fazal Mahmud Niloy"
date: "16/10/2022"
output: html_document
---

```{r}
library(ggplot2)

usap <- read.csv("usap.csv") 
names(usap)
```
# Question 1

## 1. a) Make Scatter Plots of the data

```{r}
plot(usap$gr, usap$vs, xlab="Vote Share", ylab="Growth Rate", main="Vote Share vs Growth Rate")
plot(usap$ir, usap$vs, xlab="Vote Share", ylab="Inflation Rate", main="Vote Share vs Inflation Rate", pch=19)
plot(usap$gn, usap$vs, xlab="Vote Share", ylab="Good News Quarters", main="Vote Share vs Good News Quarters", pch=19)
plot(usap$dv, usap$vs, xlab="Vote Share", ylab="Duration", main="Vote Share vs Duration", pch=19)
```

### 1. b) Fit three possible regression models for Vote share

#### Model A: using Growth rate, Inflation rate

```{r}
modelA <- lm(vs ~ gr + ir, data=usap)
# plot(usap$vs, usap$gr + usap$ir, ylab="Model B", main="vs ~ gr + ir")
summary(modelA)
# make a multiple regression plot
plot(modelA, which=1)
```

#### Model B: using Growth rate, Inflation rate, Good news quarters and Duration value

```{r}
modelB <- lm(vs ~ gr + ir + gn + dv, data=usap)
# plot(usap$vs, usap$gr + usap$ir + usap$gn + usap$dv, xlab="Vote Share", ylab="Model B", main="vs ~ gr + ir + gn + dv")
summary(modelB)
plot(modelB, which = 1)
```

#### Model C: using Growth rate, Inflation rate, Good news quarters, Duration value, President running, Party, and President running \* Party which is the interaction between President running and Party

```{r}
modelC <- lm(vs ~ gr + ir + gn + dv + pr + pwh + pr*pwh, data=usap)
# plot(usap$vs, usap$gr + usap$ir + usap$gn + usap$dv + usap$pr + usap$pwh + usap$pr*usap$pwh, xlab="vote share", ylab="Growth Rate", main="vs ~ gr + ir + gn + dv + pr + pwh + pr*pwh")
summary(modelC)
plot(modelC, which = 1)
```

## 1. c) Compare Models B and C, using the F-test with the restriction on the coefficients in the null hypothesis.

```{r}
anova(modelB, modelC)
```

From the ANOVA table we can see the F value is 3.9312 which says that the two models are significantly different. As the difference is big we would keep the better model. Now lets find the Critical value of the F distribution

Now lets find the Critical value of the F distribution:

```{r}
qf(0.05, 3, 14, lower.tail = FALSE)
```

since 3.9312 \> 3.343889, the Nested F-statistics falls in the rejection region, and we reject null hypothesis in favour of alternative Hypothesis.

#### Checking summary of modelB:

```{r}
summary(modelB)
```

#### Checking summary of modelC:

```{r}
summary(modelC)
```

As for modelC summary table ir, pr, ppr variables are non-significant and are not important for model.

From the ANOVA table we can see that alpha(0.03155) is less than 0.05, so we reject null hypothesis, thus we accept alternative hypothesis which defines at least one B5, B6, B7 is not equal to zero.

Conclusion: **modelC is better than modelB.**

## 1. d) Compare the fitted models from b) and choose your best model
```{r}
smryA <- summary(modelA)
smryB <- summary(modelB)
smryC <- summary(modelC)
# make dataframes for the summary with the adjusted r-squared values
model_summary <- data.frame(model=c("A", "B", "C"), adj.r.squared=c(smryA$adj.r.squared, smryB$adj.r.squared, smryC$adj.r.squared))
model_summary[which(model_summary$adj.r.squared == max(model_summary$adj.r.squared)),]
```
Since we are using "adjusted r-squared values" to measure models we can say that **model C** is the best model among 3.

## 1. e) Present a scatter plot of the standardised residuals against the fitted values
```{r}
ggplot(modelC, aes (x=fitted(modelC), y=rstandard(modelC))) +
  geom_point() +
  geom_line(aes(y=0), color="red") +
  ggtitle("Standardised Residuals vs Fitted Values") +
  xlab("Fitted Values") +
  ylab("Standardised Residuals")
```
From the Residual vs fitted values scatter-plot we can see,

1. From the scatter-plot we can see that there is no specific pattern of the points thus it satisfies the independence assumption.
2. The points look fairly evenly spread out, thus it satisfies constant variance assumption.
3. The relation is non-liner

## 1. f) For your best model from b), examine if there are any outliers or influential observations
we can find the outliers by following code:
```{r}
k <- ols_prep_cdplot_data(modelC)
outlierChart <- ols_prep_outlier_obs(k)
outlierChart$obs[outlierChart$fct_color == "outlier"]
```
as we can see, **observation 2, 8, 9 & 20 are potential outliers**. We can also visualize the outliers by using the following code:
```{r}
ols_plot_cooksd_bar(modelC)
```

## 1. g) Use your best model from b) to make point and interval estimates for A. Gore
```{r}
predGore <- data.frame(
  gr=usap$gr[22],
  ir=usap$ir[22],
  gn=usap$gn[22],
  dv=usap$dv[22],
  pr=usap$pr[22],
  pwh=usap$pwh[22],
  "pr:pwh"=usap$pr[22]*usap$pwh[22])
predict(modelC, predGore, interval="confidence")
predict(modelC, predGore, interval="prediction")[1,1]
```
from our observation we get vote share of **49.74993% which is close to the real value 50.3%**.

# Question 2

##